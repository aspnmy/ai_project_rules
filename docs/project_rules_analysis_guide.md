# 项目规则分析指南

## 1. 规则设置的背景与意义

### 1.1 为什么需要规则框架

在现代软件开发中，特别是涉及多平台兼容性、多团队协作和持续集成/持续部署(CI/CD)的项目中，统一的规则框架至关重要。本项目规则体系的建立基于以下核心需求：

- **标准化与一致性**：确保所有团队成员遵循相同的编码标准、文件管理和命名约定，减少沟通成本
- **跨平台兼容性**：解决Windows、Linux和macOS环境下的路径差异、文件系统特性差异等问题
- **可维护性提升**：清晰的规则使项目结构和代码逻辑更加透明，降低新成员的学习成本
- **自动化支持**：规则体系设计考虑了自动化工具的集成，便于实现自动化测试、构建和部署
- **风险管理**：通过规范化的文件管理、版本控制和配置管理，降低项目风险

### 1.2 规则优先级设计的逻辑

项目规则采用三级优先级设计（高/中/低），这一设计的核心理念是：

- **安全性与功能性优先**：高优先级规则确保项目的基本安全和功能正常运行
- **流程与一致性次之**：中优先级规则保障开发流程的顺畅和代码质量
- **优化建议作为补充**：低优先级规则提供最佳实践建议，可在资源允许时实施

这种分级机制允许开发团队在紧急情况下做出合理的权衡，确保核心功能不受影响的同时，逐步提升代码质量。

## 2. AI开发辅助框架使用指南

### 2.1 框架概述

本规则体系设计包含了完整的AI开发辅助框架，旨在支持基于UnityPlayer的游戏Mod开发。该框架提供了：

- **统一的代码结构**：标准化的目录组织和文件命名，便于AI理解和生成代码
- **自动化测试支持**：内置autotest规则，确保代码质量和可靠性
- **环境隔离机制**：通过WSL2纯净环境规则，保证开发和测试环境的一致性
- **配置管理系统**：基于环境变量和配置文件的统一管理方式
- **安全实践指导**：针对敏感信息和资源访问的安全规则

### 2.2 如何使用框架进行AI开发

#### 2.2.1 环境准备

1. **设置开发环境**：
   - 确保WSL2环境正确配置，遵循`wsl-distro.info`中的规范
   - 安装必要的开发工具，确保IDE配置符合项目规则

2. **配置环境变量**：
   - 使用`set_SystemPathVar.py`设置必要的环境变量
   - 通过`db_lists.txt`管理MCP服务器配置

#### 2.2.2 AI模型集成

1. **代码生成规范**：
   - 所有AI生成的代码必须遵循项目的命名规范和注释要求
   - 确保代码在UnityPlayer环境中兼容运行

2. **资源加载规则**：
   - 严格使用相对路径加载资源，禁止硬编码绝对路径
   - 示例：
     ```python
     import os
     current_dir = os.path.dirname(os.path.abspath(__file__))
     resource_path = os.path.join(current_dir, 'resources', 'asset.png')
     ```

3. **注释要求**：
   - 所有函数必须包含中文Markdown格式注释
   - 注释必须包含参数说明和返回值说明
   - 注释必须位于函数定义之前

#### 2.2.3 自动化测试流程

1. **测试用例编写**：
   - 为每个功能模块编写相应的测试脚本
   - 测试脚本命名遵循`*_tester.py`格式

2. **测试执行**：
   - 使用提供的测试框架执行测试用例
   - 确保测试覆盖正常流程、边界情况和异常处理

3. **日志管理**：
   - 测试日志使用UTF-8编码并包含BOM头
   - 日志文件命名符合`temp-${filename}`规范

### 2.3 AI开发最佳实践

- **代码片段复用**：利用规则体系中的标准模式加速开发
- **渐进式开发**：从核心功能开始，逐步扩展，遵循规则优先级
- **持续集成**：定期执行`check_project_config.py`验证项目配置
- **文档同步**：确保代码变更与文档同步更新

## 3. 私有规则与全局规则的区别

### 3.1 规则分类与权限

#### 3.1.1 全局规则

- **定义**：适用于整个项目的基础规则，存储在根目录的`project_rules.md`中
- **权限**：由项目核心团队维护和更新
- **优先级**：通常为高优先级或中优先级
- **适用范围**：所有项目模块和子系统
- **示例**：文件路径使用规则、Git提交规则、环境变量规则等

#### 3.1.2 私有规则

- **定义**：特定模块或功能的专用规则，存储在`rules/myproject_rules/`目录下
- **权限**：可由模块负责人维护，但需遵循全局规则的基本框架
- **优先级**：通常为中优先级或低优先级，不能与全局规则冲突
- **适用范围**：特定功能模块或项目子集
- **示例**：特定业务逻辑的命名约定、模块特定的配置规则等

### 3.2 规则关系与管理

- **继承关系**：私有规则继承并补充全局规则，不能违背全局规则的基本原则
- **冲突处理**：当私有规则与全局规则冲突时，以全局规则为准
- **更新机制**：全局规则更新时，私有规则可能需要相应调整以保持兼容性

### 3.3 如何创建和管理私有规则

1. **创建流程**：
   - 在`rules/myproject_rules/`目录下创建规则文件
   - 规则文件命名为`myproject_rules.txt`，变量定义文件命名为`myproject_vars.txt`
   - 遵循规则格式规范，确保与全局规则兼容

2. **管理建议**：
   - 定期审查私有规则的适用性
   - 评估私有规则是否有推广为全局规则的价值
   - 在项目文档中明确说明私有规则的用途和限制

## 4. 规则体系的扩展性

### 4.1 规则更新流程

当需要添加新规则或修改现有规则时，应遵循以下流程：

1. **规则评估**：分析规则的必要性和影响范围
2. **优先级确定**：根据规则重要性分配适当的优先级
3. **文档更新**：更新相应的规则文档
4. **团队通知**：确保所有团队成员了解规则变更
5. **实施监控**：跟踪规则实施情况，收集反馈

### 4.2 自定义规则指南

开发团队可以根据特定需求创建自定义规则，但应：

- 遵循现有的规则框架和优先级体系
- 确保规则名称和格式的一致性
- 提供清晰的说明和示例
- 定期审查和优化规则集

## 5. 结语

本规则分析指南旨在帮助开发团队理解项目规则体系的设计理念、使用方法以及私有规则与全局规则的关系。通过严格遵守和合理利用这些规则，可以显著提高开发效率、代码质量和项目可维护性，为基于UnityPlayer的游戏Mod开发提供坚实的基础。

规则体系本身也在不断发展和完善，欢迎团队成员提供宝贵的建议和反馈，共同推动项目的标准化和规范化进程。